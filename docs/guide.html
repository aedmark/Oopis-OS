<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OopisOS v2.6 User Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=VT323&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #18181b; /* zinc-900 */
            color: #e4e4e7; /* zinc-200 */
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .nav-link {
            transition: all 0.3s ease;
        }

        .nav-link.active, .nav-link:hover {
            background-color: #3f3f46; /* zinc-700 */
            color: #a7f3d0; /* emerald-200 */
        }

        h1, h2, h3, h4 {
            font-family: 'VT323', monospace;
            letter-spacing: 0.05em;
        }

        h1 {
            color: #34d399; /* emerald-400 */
            margin-bottom: 0.75rem;
        }

        h2 {
            color: #60a5fa; /* blue-400 */
            border-bottom: 1px solid #52525b; /* zinc-600 */
            padding-bottom: 0.25rem;
            margin-top: 1.75rem;
            margin-bottom: 1.25rem;
        }

        h3 {
            color: #facc15; /* yellow-400 */
            margin-top: 1.25rem;
            margin-bottom: 0.75rem;
        }

        h4 {
            color: #fb923c; /* orange-400 */
            margin-top: 1rem;
            margin-bottom: 0.5rem;
        }

        .content-section p,
        .content-section li {
            line-height: 1.7;
            margin-bottom: 1rem;
        }

        a {
            color: #2dd4bf; /* teal-400 */
            text-decoration: underline;
        }

        a:hover {
            color: #5eead4; /* teal-300 */
        }

        pre {
            background-color: #27272a; /* zinc-800 */
            color: #d4d4d8; /* zinc-300 */
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-family: 'VT323', monospace;
            font-size: 0.875rem; /* text-sm */
            line-height: 1.5;
            margin-top: 0.75rem;
            margin-bottom: 1.25rem;
        }

        code {
            font-family: 'VT323', monospace;
            background-color: #3f3f46; /* zinc-700 */
            color: #fde047; /* yellow-300 */
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-size: 0.9em;
        }

        pre code {
            padding: 0;
            background-color: transparent;
            color: inherit;
        }

        .sidebar {
            background-color: #27272a; /* zinc-800 */
        }

        .main-content {
            background-color: #18181b; /* zinc-900 */
        }

        .logo {
            font-family: 'VT323', monospace;
            color: #34d399; /* emerald-400 */
        }

        table {
            width: 100%;
            margin-top: 1rem;
            border-collapse: collapse;
        }

        th, td {
            border: 1px solid #52525b; /* zinc-600 */
            padding: 0.75rem;
            text-align: left;
        }

        th {
            background-color: #3f3f46; /* zinc-700 */
            font-family: 'VT323', monospace;
            color: #a7f3d0; /* emerald-200 */
        }

        .content-section ul {
            list-style-type: disc;
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }

        .content-section ol {
            list-style-type: decimal;
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }

        .terminal-example {
            background-color: #0d0d0d; /* darker than zinc-950 */
            border: 2px solid #3f3f46; /* zinc-700 */
            border-radius: 0.5rem;
            padding: 1rem;
            margin-top: 1rem;
            margin-bottom: 1.25rem;
            box-shadow: inset 0 0 10px rgba(0, 255, 0, 0.1);
        }

        .terminal-example .prompt {
            color: #60a5fa; /* blue-400 */
        }

        .terminal-example .command {
            color: #a7f3d0; /* emerald-200 */
        }

        .terminal-example .output {
            color: #e4e4e7; /* zinc-200 */
            white-space: pre-wrap;
        }

        .footer {
            border-top: 1px solid #52525b; /* zinc-600 */
            padding-top: 1rem;
            margin-top: 2rem;
            font-size: 0.875rem;
            color: #a1a1aa; /* zinc-400 */
        }

        #menu-button {
            display: none;
        }

        @media (max-width: 768px) {
            #menu-button {
                display: block;
            }

            .sidebar {
                display: none;
                width: 100%;
                height: auto;
                position: static;
            }

            .sidebar.open {
                display: block;
            }
        }
    </style>
</head>
<body class="min-h-screen">

<div class="flex flex-col md:flex-row min-h-screen">
    <button id="menu-button" class="md:hidden p-4 bg-zinc-800 text-emerald-400 fixed top-0 left-0 z-20">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
        </svg>
    </button>

    <aside class="sidebar w-full md:w-64 lg:w-72 p-6 space-y-4 fixed md:sticky top-0 h-screen overflow-y-auto z-10">
        <h1 class="logo text-4xl mb-6">OopisOS</h1>
        <nav>
            <ul class="space-y-2">
                <li><a href="#home" class="nav-link block p-3 rounded-lg active">Home & Overview</a></li>
                <li><a href="#user-guide" class="nav-link block p-3 rounded-lg">User Guide</a></li>
                <li><a href="#advanced-topics" class="nav-link block p-3 rounded-lg">Advanced Topics</a></li>
                <li><a href="#developer-docs" class="nav-link block p-3 rounded-lg">Developer Docs</a></li>
                <li><a href="#testing-env" class="nav-link block p-3 rounded-lg">Testing & Showcase</a></li>
                <li><a href="#recent-changes" class="nav-link block p-3 rounded-lg">Recent Changes</a></li>
                <li><a href="#about" class="nav-link block p-3 rounded-lg">About & Credits</a></li>
            </ul>
        </nav>
    </aside>

    <main class="main-content flex-1 p-6 md:p-10 overflow-y-auto mt-16 md:mt-0">
        <section id="home" class="content-section active">
            <h1>Welcome to OopisOS!</h1>
            <p class="text-lg mt-2 mb-6 text-zinc-400">The little browser-based Operating System that could. Now at Version 2.6 and more powerful than ever!</p>

            <div class="terminal-example">
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command">set GREETING="Hello, world!" ; echo $GREETING</span><br>
                <span class="output">Hello, world!</span>
            </div>

            <h2>What is this place?</h2>
            <p>Glad you asked! OopisOS (v2.6) is a fully persistent, self-contained operating system simulation that runs entirely within your web browser. It's a love letter to the command-line interfaces of yore, but with a modern twist. Think of it as a digital terrarium where you can poke around, learn about OS concepts, and generally cause harmless digital mayhem without setting your actual computer on fire. It was lovingly crafted by Andrew Edmark and his trusty AI sidekick, Gemini.</p>
            <p>The entire system is a showcase of what's possible with modern JavaScript and a dash of nostalgia. Your files, users, and even your command history will be here waiting for you the next time you visit, thanks to the magic of IndexedDB and localStorage.</p>

            <h2>Core Philosophy</h2>
            <ul class="list-disc ml-6 space-y-2 my-4">
                <li><strong>Look, Don't Touch (Your Real Stuff):</strong> A safe sandbox to learn and experiment. Your real files are safe. Probably.</li>
                <li><strong>Meow-nificently Self-Contained:</strong> Everything runs on your machine. No servers, no cloud, just pure client-side goodness. You could run this on a spaceship to Xenon, no internet required.</li>
                <li><strong>Learn & Laugh:</strong> It's an educational tool, but who said learning can't be fun? We have an AI and video games. Your move, calculus.</li>
                <li><strong>More Modular Than a Space Station:</strong> Built with discrete components, making it easier for brave developers to add new features or, more likely, new and exciting bugs.</li>
                <li><strong>UNIX-ish... ish:</strong> If you've used a Linux or Mac terminal, you'll feel right at home. The commands might not ask you for your papers, but they'll respect your authority.</li>
            </ul>

            <h2>Key Features at a Glance (v2.6)</h2>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li><strong>A File System That Remembers:</strong> Create, edit, and manage files and directories that actually stick around! Features a full suite of commands including the super-powered `find`, `ls`, `diff`, and the new `tree` command.</li>
                <li><strong>A Command-Line for the Connoisseur:</strong> A beautiful retro terminal with history (up/down arrows), tab completion, command pipelining (`|`), I/O redirection (`>` for overwrite, `>>` for append), background processes (`&`), and command sequences (`;`).</li>
                <li><strong>Multi-User Mayhem with Groups:</strong> Register multiple users (`useradd`) with secure, hashed passwords, `login`, `logout`, switch users with `su` (including to the all-powerful `root`), and manage users with `whoami`, `listusers`, and `removeuser`. Now with user groups (`groupadd`, `usermod`, `groups`, `groupdel`) for fine-grained permissions!</li>
                <li><strong>Command Your Commands (`alias`, `set`):</strong> Create your own command shortcuts with `alias` and session-specific variables with `set`/`unset`.</li>
                <li><strong>Background Job Control (`ps`, `kill`):</strong> See what processes you've sent to the background with `ps` and terminate them with `kill`.</li>
                <li><strong>Networking Utilities (`wget`, `curl`):</strong> Fetch content and download files from the web directly within the OS.</li>
                <li><strong>The 'edit' Command - Now More Luxurious:</strong> A souped-up text editor that handles plain text, Markdown, and HTML with a live preview. Features include line numbers, a detailed status bar, toggleable word wrap, multiple view modes (`Ctrl+P`), an `Export to HTML` function, and a rich formatting toolbar with shortcuts.</li>
                <li><strong>The 'paint' Command - An Artist's Studio:</strong> Unleash your inner artist with a character-based paint program. Supports multiple colors, undo/redo, and saves to a custom `.oopic` file format.</li>
                <li><strong>The 'chidi' Command - Your Personal AI Librarian:</strong> An advanced Markdown reader that recursively finds all `.md` files in a path and lets you use AI to summarize, study, and ask questions about them, either individually or all at once.</li>
                <li><strong>An AI in the Shell (`gemini`):</strong> Chat with the Gemini AI directly from your terminal. Ask it to write a poem, summarize a file, or start a new conversation with the `-n` flag. It can now use `tree` and other tools to better understand your files.</li>
                <li><strong>Scripting for the Masses (`run`):</strong> Write your own command scripts! Supports comments (`#`), argument passing (`$1`, `$2`, `$@`, `$#`), and includes handy tools like `delay` and `check_fail` for crafting your own diagnostic epics.</li>
                <li><strong>Save Your Progress! (No, really):</strong> Automatic session saving per user, plus manual `savestate`/`loadstate` and `backup`/`restore` commands. `clearfs` lets you clean your home directory, and `reset` is the big red button that nukes everything (don't worry, we'll ask first).</li>
                <li><strong>A Grab-Bag of Utilities:</strong> `echo`, `date`, `help`, `clear`, `history`, `export`, `upload`, `reboot`, `chmod`, `chown`, `chgrp`, `grep` (with `-R`!), and `printscreen` to save your terminal's glorious output to a file.</li>
                <li><strong>It's a Video Game, Too! (`adventure`):</strong> Tired of being productive? Launch a text-based adventure game! Explore the 'Lost Key of Oopis' or load your own custom JSON-based adventures.</li>
            </ul>
            <p>Go on, get your hands dirty. The world of OopisOS v2.6 awaits!</p>
        </section>

        <section id="user-guide" class="content-section">
            <h1>OopisOS User Guide (v2.6)</h1>
            <p>So, you've decided to venture forth. Excellent! You have selected the path of a true adventurer. This guide is your map and spellbook for the realm of OopisOS v2.6.</p>

            <h2>The Terminal Interface</h2>
            <p>This is your window into the soul of the machine. Your command center. Your... well, it's a terminal.</p>
            <div class="terminal-example">
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command">_</span>
            </div>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li><strong>The Prompt:</strong> This tells you who you are, where you are, and that the system is ready for your brilliant commands. It follows the format: `username@hostname:current_path>`.</li>
                <li><strong>The Input Area:</strong> The blinking cursor is your cue. Type your incantations here.</li>
                <li><strong>The Output Area:</strong> The results of your digital wizardry (and the occasional error message) will appear here.</li>
            </ul>

            <h2>Essential Commands</h2>
            <p>These are the fundamental spells in your arsenal. For a full grimoire, type <code>help</code>. For the nitty-gritty on a single command, type <code>man [command_name]</code>.</p>
            <table class="min-w-full divide-y divide-zinc-700">
                <thead>
                <tr>
                    <th class="px-4 py-2">Command & Key Flags</th>
                    <th class="px-4 py-2">What It Does (In Plain English)</th>
                </tr>
                </thead>
                <tbody class="divide-y divide-zinc-800">
                <tr><td><code>help [cmd]</code></td><td>Your friendly neighborhood guide. Ask it about other commands.</td></tr>
                <tr><td><code>ls [-l -a -R -r -t -S -X -U -d]</code></td><td>"Look." Shows directory contents. Use flags for: <b>-l</b>ong, <b>-a</b>ll, <b>-R</b>ecursive, <b>-r</b>everse sort, sorT by <b>-t</b>ime, <b>-S</b>ize, e<b>-X</b>tension, <b>-U</b>nsorted, or list <b>-d</b>irectories themselves.</td></tr>
                <tr><td><code>cd [directory]</code></td><td>Change directory. Or, "Go north."</td></tr>
                <tr><td><code>pwd</code></td><td>"Where am I?!" Prints your current location.</td></tr>
                <tr><td><code>mkdir [-p] [dir_name]</code></td><td>Creates a directory. Use <b>-p</b> to make parent directories as needed.</td></tr>
                <tr><td><code>tree [-L level] [-d]</code></td><td>Shows directory contents in a beautiful tree format. <b>-L</b> for depth, <b>-d</b> for directories only.</td></tr>
                <tr><td><code>cat [file...]</code></td><td>Reads file contents to the screen. Can read multiple files.</td></tr>
                <tr><td><code>echo [text]</code></td><td>Repeats text. Primarily used with redirection to write to files.</td></tr>
                <tr><td><code>edit [file]</code></td><td>Opens the powerful text editor. Your gateway to creating masterpieces.</td></tr>
                <tr><td><code>paint [file.oopic]</code></td><td>Unleash your inner artist! Opens the character-based art editor.</td></tr>
                <tr><td><code>chidi [path]</code></td><td>Opens the advanced Markdown reader and AI analysis tool.</td></tr>
                <tr><td><code>touch [-c] [file]</code></td><td>Creates an empty file or updates its timestamp. Use <b>-c</b> to not create.</td></tr>
                <tr><td><code>rm [-r -f -i] [item]</code></td><td>Removes things. Permanently. Use <b>-r</b> for directories, <b>-f</b> to be forceful, and <b>-i</b> to be asked first.</td></tr>
                <tr><td><code>cp [-r -f -p -i] [src] [dest]</code></td><td>Copies files. Flags for: <b>-r</b>ecursive, <b>-f</b>orce, <b>-p</b>reserve metadata, <b>-i</b>nteractive.</td></tr>
                <tr><td><code>mv [-f -i] [src] [dest]</code></td><td>Moves or renames files. Flags for: <b>-f</b>orce, <b>-i</b>nteractive.</td></tr>
                <tr><td><code>diff [file1] [file2]</code></td><td>Compares two files and shows the differences.</td></tr>
                <tr><td><code>grep [-i -v -n -c -R] [pat] [file]</code></td><td>Finds text in files. Flags for: case-<b>i</b>nsensitive, in<b>-v</b>ert, line <b>-n</b>umber, <b>-c</b>ount, <b>-R</b>ecursive.</td></tr>
                <tr><td><code>find [path] [expr]</code></td><td>A powerful detective to find files by name, type, permissions, and more.</td></tr>
                <tr><td><code>printscreen [file]</code></td><td>Saves everything you see on the terminal screen to a file.</td></tr>
                <tr><td><code>run [script] [args...]</code></td><td>Executes a script file. Can pass arguments to the script.</td></tr>
                <tr><td><code>alias [name='value']</code></td><td>Create your own command shortcuts. Type `alias` to see them all.</td></tr>
                <tr><td><code>unalias [name]</code></td><td>Remove a command shortcut.</td></tr>
                <tr><td><code>set [VAR="val"]</code></td><td>Set a temporary environment variable. Type `set` to see them all.</td></tr>
                <tr><td><code>unset [VAR]</code></td><td>Remove an environment variable.</td></tr>
                <tr><td><code>ps</code></td><td>List your background processes (jobs).</td></tr>
                <tr><td><code>kill [job_id]</code></td><td>Stop a running background process.</td></tr>
                <tr><td><code>wget [-O file] [url]</code></td><td>Downloads a file from a URL. Use <b>-O</b> to specify the output filename.</td></tr>
                <tr><td><code>curl [-o file] [url]</code></td><td>Transfers data from a URL, printing to screen. Use <b>-o</b> to save to a file.</td></tr>
                <tr><td><code>adventure [file.json]</code></td><td>Time for a break! Starts a text adventure. Can load custom games.</td></tr>
                <tr><td><code>gemini [-n] "[prompt]"</code></td><td>Consult the oracle (Gemini AI). Use <b>-n</b> to start a new conversation.</td></tr>
                <tr><td><code>useradd, login, logout</code></td><td>Manage user accounts. `useradd` creates one, `login` signs in, `logout` signs out.</td></tr>
                <tr><td><code>whoami, listusers, removeuser</code></td><td>See who you are, list all users, or remove a user (requires confirmation).</td></tr>
                <tr><td><code>su [username]</code></td><td>"Substitute User." Become someone else (defaults to `root`).</td></tr>
                <tr><td><code>chmod, chown, chgrp</code></td><td>Manage file permissions (`chmod 755 file`), ownership (`chown guest file`), and group (`chgrp staff file`).</td></tr>
                <tr><td><code>groups, groupadd, groupdel, usermod</code></td><td>Manage user groups. See who belongs to what, create/delete groups, and add users to groups.</td></tr>
                <tr><td><code>upload [-f], export</code></td><td>`upload` files from your computer (<b>-f</b>orce overwrite), `export` files back out.</td></tr>
                <tr><td><code>backup, restore</code></td><td>Create a full JSON `backup` of the OS state, or `restore` from one.</td></tr>
                <tr><td><code>savestate, loadstate</code></td><td>Manually `savestate` your current user's session, and `loadstate` to bring it back.</td></tr>
                <tr><td><code>clearfs, reset, reboot</code></td><td>Drastic measures! `clearfs` wipes your home dir, `reset` nukes the OS, and `reboot` reloads the page.</td></tr>
                <tr><td><code>clear, history, date</code></td><td>`clear` the screen, view command `history` (or `history -c` to clear it), see the current `date`.</td></tr>
                </tbody>
            </table>

            <h2>The File System</h2>
            <p>OopisOS has a file system not unlike the ones you know. It's a tree, and you're a digital squirrel.</p>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li>The very top is the root directory, <code>/</code>.</li>
                <li>Paths are your branches, separated by <code>/</code>.</li>
                <li><code>.</code> means "right here."</li>
                <li><code>..</code> means "go back one branch."</li>
                <li>Files starting with a <code>.</code> are shy; use <code>ls -a</code> to see them.</li>
            </ul>

            <h2>The Editor (`edit` command)</h2>
            <p>The `edit` command is your passage to a world of creation. It's more than a notepad; it's a multi-tool for text.</p>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li><strong>File Types:</strong> It understands plain text, Markdown (`.md`), and HTML (`.html`). Give it a recognized file extension, and it'll unlock special features.</li>
                <li><strong>Live Preview:</strong> For Markdown and HTML, a magical preview pane shows you what your code looks like, updated in real time.</li>
                <li><strong>Formatting Toolbar:</strong> For `.md` and `.html` files, a toolbar appears! Click to add bold, italics, links, quotes, code blocks, and lists, saving you from remembering the syntax.</li>
                <li><strong>Status Bar:</strong> A handy bar at the bottom shows cursor position (line, column), total lines, word count, and character count.</li>
                <li><strong>Word Wrap:</strong> Toggle it on for prose, off for code. Your preference is saved for next time.</li>
                <li><strong>Export to HTML:</strong> Click the "Export" button to download a fully rendered HTML file of your Markdown/HTML preview.</li>
                <li>
                    <strong>Shortcuts to Glory:</strong>
                    <ul>
                        <li><code>Ctrl+S</code>: Save & Exit. The hero's exit.</li>
                        <li><code>Ctrl+O</code>: Exit. If you haven't saved, we'll ask before you discard your genius.</li>
                        <li><code>Ctrl+P</code>: Toggle Preview. Cycle through split-screen, code-only, and preview-only views.</li>
                        <li><code>Ctrl+B</code> / <code>Ctrl+I</code>: Make text **bold** or *italic* in compatible files.</li>
                        <li><code>Tab</code>: Indent your code like a pro.</li>
                    </ul>
                </li>
            </ul>

            <h2>The ASCII Art Studio (`paint` command)</h2>
            <p>For when text is not enough, OopisOS includes a surprisingly powerful character-based art editor. The <code>paint</code> command opens a dedicated, full-screen canvas where you can create ASCII and ANSI art.</p>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li><strong>Canvas & Tools:</strong> The editor features an 80x24 character canvas. Use the Pencil tool to draw with a selected character and color, or the Eraser tool to clear cells.</li>
                <li><strong>Color Palette:</strong> Add a splash of color to your creations with a 6-color ANSI palette (green, red, sky, amber, lime, neutral).</li>
                <li><strong>File Format:</strong> Your masterpieces are saved to a custom <code>.oopic</code> file format, which stores character, color, and canvas dimension data in a JSON structure.</li>
                <li>
                    <strong>Keyboard-First Workflow:</strong>
                    <ul>
                        <li><code>P</code> / <code>E</code>: Switch between Pencil and Eraser tools.</li>
                        <li><code>1-6</code>: Select a color from the palette.</li>
                        <li>Any other character key: Sets the character to be used by the pencil.</li>
                        <li><code>Ctrl+S</code>: Save & Exit.</li>
                        <li><code>Ctrl+O</code>: Exit without saving (will prompt if there are unsaved changes).</li>
                        <li><code>Ctrl+Z</code> / <code>Ctrl+Y</code>: Undo and Redo your strokes.</li>
                    </ul>
                </li>
            </ul>

            <h2>The AI Librarian (`chidi` command)</h2>
            <p>The `chidi` command launches a powerful Markdown reader and analysis tool. When you run `chidi` on a file or directory, it finds all `.md` files and loads them into a dedicated reading interface.</p>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li><strong>Focused Reading:</strong> Presents a clean, rendered view of your Markdown files, free from terminal distractions.</li>
                <li><strong>Multi-File Navigation:</strong> If you target a directory, you can easily navigate between all found `.md` files using PREV/NEXT buttons or a file selector dropdown menu.</li>
                <li><strong>AI Integration:</strong> Chidi uses the Gemini AI to provide powerful analysis tools for your documents. You can summarize the current document, ask for study questions, or even ask a question across all loaded documents at once.</li>
                <li><strong>Export View:</strong> You can export the current view, including any AI-generated summaries or answers, as a single, self-contained HTML file for easy sharing or archiving.</li>
            </ul>

            <h2>Users, Groups, and Permissions</h2>
            <p>OopisOS isn't a free-for-all. It's a sophisticated society of users with rules, groups, and private property. Passwords are securely hashed, never stored in plain text.</p>

            <h3>User Accounts & The Superuser (`root`)</h3>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li>
                    <strong>Default Population:</strong> OopisOS comes with a few residents:
                    <ul>
                        <li><code>Guest</code>: Your default identity. No password needed. Every user is in their own primary group by default (e.g., user 'Guest' is in group 'Guest').</li>
                        <li><code>root</code>: The system administrator. The superuser. The big cheese. The `root` user can do anything. The default password is <code>mcgoopis</code>.</li>
                        <li><code>userDiag</code>: A special user for running tests, with the password <code>pantload</code>.</li>
                    </ul>
                </li>
                <li><code>useradd [username]</code>: Create a new user. You'll be prompted to create a password in a secure, obscured input field. A primary group with the same name is also created.</li>
                <li><code>login [username]</code>: Log in as someone else. If a password is required, you'll be prompted securely.</li>
                <li><code>logout</code>: Return to the previous user in the session stack.</li>
                <li><code>su [username]</code>: Switch to another user, assuming you know their password (or you're `root`). Defaults to `root`.</li>
            </ul>

            <h3>Permissions and Ownership (`chmod`, `chown`, `chgrp`)</h3>
            <p>Use <code>ls -l</code> to view permissions like <code>-rwxr-x---</code>. This string represents: [type][owner permissions][group permissions][other permissions].</p>
            <div class="terminal-example">
                <span class="prompt">root@OopisOs:/&gt;</span> <span class="command">touch newfile.txt ; ls -l newfile.txt</span><br>
                <span class="output">-rw-r--r--  1 root    root        0 Jun 21 11:34 newfile.txt</span>
            </div>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li>
                    <code>chmod [mode] [path]</code>: Change a file's permissions. Mode is a 3-digit octal number (0-7). The digits represent Owner, Group, and Other. Permissions are: 4 (read), 2 (write), 1 (execute). Add them up for the desired combination!
                    <ul>
                        <li><code>chmod 755 myfile</code>: Owner gets 7 (4+2+1 -> rwx), group gets 5 (4+0+1 -> r-x), others get 5 (r-x).</li>
                        <li><code>chmod 640 myfile</code>: Owner gets 6 (4+2+0 -> rw-), group gets 4 (4+0+0 -> r--), others get 0 (---).</li>
                    </ul>
                </li>
                <li><code>chown [new_owner] [path]</code>: Change who owns a file. Only `root` can do this.</li>
                <li><code>chgrp [new_group] [path]</code>: Change a file's group. Only the owner or `root` can do this.</li>
            </ul>

            <h2>Pipes, Redirection, Sequences, and Environment Variables</h2>
            <p>Chain your commands together for ultimate power!</p>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li><strong>Pipes <code>|</code></strong>: Take the output of the command on the left and "pipe" it as the input for the command on the right. <br>Example: `history | grep "sudo"`</li>
                <li><strong>Output Redirection <code>></code></strong>: Send a command's output into a file, overwriting whatever was there. <br>Example: `ls -l > file_list.txt`</li>
                <li><strong>Append Output <code>>></code></strong>: Add a command's output to the end of a file. <br>Example: `echo "A new event happened!" >> activity.log`</li>
                <li><strong>Command Separator <code>;</code></strong>: Run several commands, one after the other, on a single line. <br>Example: `cd / ; ls ; pwd`</li>
                <li><strong>Background Process <code>&</code></strong>: Run a command in the background and continue working. <br>Example: `delay 5000 &`</li>
                <li><strong>Environment Variables <code>$VAR</code></strong>: Use <code>set VAR="value"</code> to create session-specific variables, and use them with a `$` prefix (e.g., `echo $VAR`).</li>
            </ul>
        </section>

        <section id="advanced-topics" class="content-section">
            <h1>OopisOS v2.6: Advanced Topics & Features</h1>
            <p>You've mastered the basics. You feel the power coursing through your veins. Now, let's get dangerous.</p>

            <h2>The `find` Command: Your All-Seeing Eye</h2>
            <p>The <code>find</code> command is one of the most powerful tools in OopisOS. It recursively searches for files and directories based on a wide range of criteria and can even perform actions on the results.</p>
            <h4>Usage: <code>find [path...] [expression...]</code></h4>
            <p>An expression is made up of tests, operators, and actions.</p>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li>
                    <strong>Tests:</strong>
                    <ul>
                        <li><code>-name [pattern]</code>: Find files by name (e.g., "*.txt").</li>
                        <li><code>-type [f|d]</code>: Find by type (<b>f</b>ile or <b>d</b>irectory).</li>
                        <li><code>-user [username]</code>: Find files owned by a specific user.</li>
                        <li><code>-perm [mode]</code>: Find by exact permission mode (e.g., 755).</li>
                        <li><code>-mtime [+N|-N|N]</code>: Find by modification time in days (e.g., `+7` for older than 7 days, `-2` for newer than 2 days).</li>
                        <li><code>-newermt [date_string]</code>: Find files modified more recently than the given date string (e.g., "1 day ago", "2025-01-01").</li>
                    </ul>
                </li>
                <li>
                    <strong>Operators:</strong>
                    <ul>
                        <li><code>-not</code> or <code>!</code>: Inverts the next test (e.g., `find . -not -name "*.txt"`).</li>
                        <li><code>-o</code> or <code>-or</code>: Logical OR between tests.</li>
                        <li>(Implicit AND): Tests are ANDed together by default.</li>
                    </ul>
                </li>
                <li>
                    <strong>Actions:</strong>
                    <ul>
                        <li><code>-print</code>: The default action. Prints the path of the found item.</li>
                        <li><code>-delete</code>: Deletes the found item. Use with extreme caution!</li>
                        <li><code>-exec [command] {} ;</code>: Executes a command on the found file. <code>{}</code> is replaced with the file path. The command must end with a semicolon <code>;</code>.</li>
                    </ul>
                </li>
            </ul>
            <div class="terminal-example">
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command"># Find all .log files modified in the last day and delete them</span><br>
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command">find /data/logs -name "*.log" -mtime -1 -delete</span><br><br>
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command"># Change permissions on all shell scripts in your home directory</span><br>
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command">find . -name "*.sh" -exec chmod 755 {} ;</span>
            </div>

            <h2>Managing Background Processes (`ps` & `kill`)</h2>
            <p>Sent a long-running task to the background with `&` and now you regret it? Or maybe you just want to see what's still churning away. OopisOS v2.6 gives you the tools to be the master of your background jobs.</p>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li><code>ps</code>: Stands for "Process Status". This command gives you a neat list of all the commands currently running in the background. Each job has a unique Process ID (PID) that you can use to interact with it.</li>
                <li><code>kill [PID]</code>: The solution to a runaway process. Use this command with the PID from `ps` to terminate a background job immediately.</li>
            </ul>
            <div class="terminal-example">
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command">delay 10000 &</span><br>
                <span class="output">[1] Backgrounded.</span><br>
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command">delay 20000 &</span><br>
                <span class="output">[2] Backgrounded.</span><br>
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command">ps</span><br>
                <span class="output">
                        PID   COMMAND
                        1     delay 10000
                        2     delay 20000
                    </span><br>
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command">kill 1</span><br>
                <span class="output">Signal sent to terminate job 1.</span><br>
                <span class="output">[Job 1 finished with error: delay: Operation cancelled. (Reason: Killed by user command.)]</span>
            </div>

            <h2>Connecting to the World: `wget` & `curl`</h2>
            <p>OopisOS can now reach beyond its digital borders! The `wget` and `curl` commands allow you to interact with the real-world internet, downloading files and fetching data directly into your virtual environment. Please note that these commands are subject to the browser's Cross-Origin Resource Sharing (CORS) policies, so they may not work with all websites.</p>
            <h4><code>wget [-O file] [url]</code></h4>
            <p>The "web get" command. Its primary purpose is to download files. By default, it saves the file with its original name from the URL.</p>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li><code>-O [file]</code>: Use this flag to specify a different output filename.</li>
            </ul>
            <div class="terminal-example">
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command"># Download the OopisOS license and save it locally as 'LICENSE.txt'</span><br>
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command">wget https://raw.githubusercontent.com/aedmark/Oopis-OS/master/LICENSE.txt</span><br>
                <span class="output">...</span><br>
                <span class="output">'LICENSE.txt' saved [1132 bytes]</span>
            </div>
            <h4><code>curl [-o file] [url]</code></h4>
            <p>A versatile data transfer tool. By default, `curl` fetches the content from a URL and prints it directly to your terminal screen. This is great for quickly viewing data from APIs or reading simple text files without saving them.</p>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li><code>-o [file]</code>: Use this flag to redirect the output to a file instead of the screen.</li>
            </ul>
            <div class="terminal-example">
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command"># Get a piece of wisdom from the GitHub Zen API</span><br>
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command">curl https://api.github.com/zen</span><br>
                <span class="output">Mind your words, they are important.</span>
            </div>
            <h2>Scripting with `run`</h2>
            <p>Why type commands one by one like a peasant? Automate your reign with the <code>run</code> command. Create a text file ending in <code>.sh</code> and fill it with your orders.</p>
            <pre><code class="language-bash">
# Example: /scripts/myscript.sh
#!/bin/oopis_shell # This is just for show, but it looks cool, right?

# This is a comment, where I hide my secrets.
echo "Greetings, agent $1. Your mission involves $# operatives."
echo "All operatives: $@"

mkdir /kittens
echo "Mission file created for $1." > /kittens/secret_mission.txt
                </code></pre>
            <p>To unleash it upon your system (make it executable first!):</p>
            <div class="terminal-example">
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command">chmod 755 /scripts/myscript.sh</span><br>
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command">run /scripts/myscript.sh AgentK "Mr. Bigglesworth" "The Janitor"</span>
            </div>

            <h3>Scripting Superpowers:</h3>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li>
                    <strong>Argument Passing:</strong>
                    <ul>
                        <li><code>$1</code>, <code>$2</code>, ...: Use the arguments you passed to the script.</li>
                        <li><code>$@</code>: All the arguments as a single string.</li>
                        <li><code>$#</code>: The number of arguments.</li>
                    </ul>
                </li>
                <li><strong>Error Handling:</strong> If a command fails, the script stops. No questions asked.</li>
                <li>
                    <strong>Scripting Tools:</strong>
                    <ul>
                        <li><code>delay [milliseconds]</code>: For dramatic pauses.</li>
                        <li><code>check_fail "[command]"</code>: A special tool for testing. It succeeds only if the command inside it *fails*.</li>
                    </ul>
                </li>
            </ul>

            <h2>Text Adventure Gaming (`adventure`)</h2>
            <p>All work and no play makes Guest a dull user. OopisOS v2.6 includes a text adventure game engine to satisfy your inner Roberta Williams or Scott Adams.</p>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li><strong>Start Your Quest:</strong> Simply type `adventure` to begin the epic 'The Lost Key of Oopis.'</li>
                <li><strong>Bring Your Own Adventure:</strong> Got a story to tell? Write it in the specified JSON format, `upload` it, and run it with `adventure /path/to/your_game.json`.</li>
                <li><strong>Immersive Interface:</strong> The game runs in a dedicated modal window, freeing you from the distractions of the terminal.</li>
            </ul>
        </section>

        <section id="developer-docs" class="content-section">
            <h1>OopisOS v2.6: Developer Documentation</h1>

            <h2>1. Introduction</h2>
            <p>This documentation provides a comprehensive technical overview of the OopisOS v2.6 project. It is intended for developers who wish to understand, modify, or extend the system. OopisOS is a sophisticated, client-side web application that simulates a Unix-like operating system, emphasizing modularity, extensibility, and modern JavaScript practices.</p>

            <h2>2. Project Overview</h2>
            <p>OopisOS is a self-contained, browser-based terminal environment. Key characteristics include:</p>
            <ul>
                <li><strong>100% Client-Side:</strong> The application runs entirely in the browser, with no backend server dependency.</li>
                <li><strong>Persistent State:</strong> Data, including the file system, user credentials, and session information, is persisted locally using <code>IndexedDB</code> and <code>localStorage</code>.</li>
                <li><strong>Modular Architecture:</strong> The system is composed of discrete manager modules and a file-based command registration system, promoting maintainability and extensibility.</li>
                <li><strong>Rich Feature Set:</strong> Includes a hierarchical file system, a multi-user model with groups and permissions, a suite of ~60 commands, I/O redirection and piping, background job control, and several full-screen applications (<code>edit</code>, <code>paint</code>, <code>chidi</code>, <code>adventure</code>).</li>
            </ul>

            <h2>3. Architecture</h2>
            <p>OopisOS is built on a modular architecture where different concerns are handled by specialized manager objects.</p>
            <ol>
                <li><strong>Core System & Entry Point</strong>
                    <ul>
                        <li><code>index.html</code>: The main entry point. It defines the basic DOM structure and is responsible for loading all necessary JavaScript modules in the correct order.</li>
                        <li><code>main.js</code>: Handles the OS boot sequence (<code>window.onload</code>), caching essential DOM elements, initializing all managers, and setting up the primary terminal event listeners.</li>
                        <li><code>config.js</code>: A central module providing system-wide configuration constants, from API endpoints to default file permissions and UI message strings.</li>
                        <li><code>utils.js</code>: A collection of globally accessible, stateless utility functions for tasks like DOM element creation, string formatting, and data validation.</li>
                    </ul>
                </li>
                <li><strong>Command Processing Layer</strong>
                    <ul>
                        <li><code>lexpar.js</code>: Contains the <strong>Lexer</strong> and <strong>Parser</strong>. The Lexer transforms the raw command string into a sequence of tokens (e.g., <code>WORD</code>, <code>OPERATOR_PIPE</code>). The Parser then consumes this token stream to build a structured, executable representation of command pipelines.</li>
                        <li><code>commexec.js</code>: The <strong>CommandExecutor</strong> is the central orchestrator for all command execution. It does <em>not</em> contain command logic itself. Instead, it processes the parsed pipelines, manages I/O between piped commands, handles output redirection (<code>&gt;</code>/<code>&gt;&gt;</code>), and launches/manages background processes (<code>&amp;</code>).</li>
                        <li><code>scripts/commands/registry.js</code>: The <strong>CommandRegistry</strong> provides a central <code>register</code> function. Each individual command file calls this function to make the <code>CommandExecutor</code> aware of its existence, definition, and help text.</li>
                        <li><code>scripts/commands/*.js</code>: Each file in this directory defines a single command, its validation rules, and its core logic. This modular approach keeps command logic isolated and maintainable.</li>
                    </ul>
                </li>
                <li><strong>State & Persistence Layer</strong>
                    <ul>
                        <li><code>storage.js</code>: Implements the <code>StorageManager</code> (a robust wrapper for <code>localStorage</code>) and the <code>IndexedDBManager</code> (which handles the database connection for the file system).</li>
                        <li><code>fs_manager.js</code>: The <strong>FileSystemManager</strong> controls the in-memory representation of the virtual file system (<code>fsData</code>) and orchestrates saving it to and loading it from <code>IndexedDB</code>.</li>
                        <li><code>user_manager.js</code>: The <strong>UserManager</strong> and <strong>GroupManager</strong> handle user accounts, authentication (password hashing, login/su flow), and group memberships.</li>
                        <li><code>session_manager.js</code>: Contains the <strong>SessionManager</strong> (which manages the user stack for <code>su</code>/<code>logout</code> and manual/automatic session state snapshots) and the <strong>EnvironmentManager</strong> (which handles session-specific variables like <code>$USER</code> and <code>$PATH</code>).</li>
                    </ul>
                </li>
                <li><strong>UI & Interaction Layer</strong>
                    <ul>
                        <li><code>terminal_ui.js</code>: Manages all interactive components of the terminal, including the prompt, the user input line, tab completion logic (<code>TabCompletionManager</code>), and modal dialogs (<code>ModalManager</code>, <code>ModalInputManager</code>).</li>
                        <li><code>output_manager.js</code>: The sole conduit for displaying text on the terminal screen. It handles formatting, styling, and console overrides.</li>
                    </ul>
                </li>
                <li><strong>Applications</strong>
                    <ul>
                        <li><code>editor.js</code>: The full-screen text editor application (<code>edit</code>).</li>
                        <li><code>oopis_paint.js</code>: The character-based art studio application (<code>paint</code>).</li>
                        <li><code>chidi_app.js</code>: The AI-powered Markdown analyzer (<code>chidi</code>).</li>
                        <li><code>text_adventure.js</code>: The text adventure game engine (<code>adventure</code>).</li>
                    </ul>
                </li>
            </ol>

            <h2>4. Setup and Installation</h2>
            <h3>Prerequisites</h3>
            <p>A modern web browser that supports ES6+ JavaScript, <code>IndexedDB</code>, and the Web Crypto API. For local development, a simple web server is required to handle file loading without running into CORS issues.</p>
            <h3>Development Setup</h3>
            <ol>
                <li>Clone or download the project repository.</li>
                <li>Navigate to the project's root directory in your local terminal.</li>
                <li>Start a local web server. A simple one can be run with Python: <code>python -m http.server</code>.</li>
                <li>Open your browser and navigate to the local server's address (e.g., <code>http://localhost:8000</code>).</li>
            </ol>
            <h3>Project Structure</h3>
            <pre><code>
oopisOS/
├── docs/                 # Documentation files (guide.html, zine.html, etc.)
├── extras/               # Helper scripts (diag.sh, inflate.sh)
├── scripts/
│   ├── commands/         # <-- All individual command definitions reside here
│   │   ├── ls.js
│   │   ├── cat.js
│   │   └── ... (60+ command files)
│   ├── chidi_app.js
│   ├── commexec.js       # Command Executor
│   ├── config.js
│   ├── editor.js
│   ├── fs_manager.js
│   ├── lexpar.js
│   ├── main.js           # Main boot sequence
│   ├── marked.min.js     # Markdown parsing library
│   ├── oopis_paint.js
│   ├── output_manager.js
│   ├── registry.js       # Command Registry
│   ├── session_manager.js
│   ├── storage.js
│   ├── terminal_ui.js
│   ├── text_adventure.js
│   ├── user_manager.js
│   └── utils.js
├── style.css             # Unified stylesheet
├── index.html            # Main application entry point
└── LICENSE.txt
            </code></pre>

            <h2>5. Adding New Commands</h2>
            <p>The v2.6 architecture makes adding new commands simple and clean.</p>
            <h3>Step 1: Create the Command File</h3>
            <p>Create a new JavaScript file in the <code>scripts/commands/</code> directory (e.g., <code>mycommand.js</code>).</p>
            <h3>Step 2: Define the Command</h3>
            <p>Inside your new file, create an IIFE and define your command using the declarative object pattern. Register it with the <code>CommandRegistry</code>.</p>
            <pre><code class="language-javascript">
// scripts/commands/mycommand.js
(() => {
    "use strict";

    // 1. Define the command's behavior and requirements.
    const myCommandDefinition = {
        commandName: "mycommand",
        flagDefinitions: [
            { name: "verbose", short: "-v", long: "--verbose" }
        ],
        argValidation: {
            min: 1,
            error: "Usage: mycommand [-v] &lt;path&gt;"
        },
        pathValidation: [
            {
                argIndex: 0, // Validate the first argument (at index 0) as a path.
                options: { expectedType: Config.FILESYSTEM.DEFAULT_FILE_TYPE }
            }
        ],
        permissionChecks: [
            {
                pathArgIndex: 0,
                permissions: ["read"]
            }
        ],
        // 2. Write the core logic. It only runs if all the above checks pass.
        coreLogic: async (context) => {
            // The context object contains everything you need, fully validated.
            const { args, flags, currentUser, validatedPaths } = context;

            // validatedPaths[0] is guaranteed to be a valid, readable file path object.
            const pathInfo = validatedPaths[0];

            if (flags.verbose) {
                await OutputManager.appendToOutput(`Verbose mode ON for user ${currentUser}`);
            }

            // Command implementation goes here...
            const content = pathInfo.node.content;

            return {
                success: true,
                output: `Successfully processed ${pathInfo.resolvedPath}. Content length: ${content.length}.`
            };
        }
    };

    // 3. Define the help texts for 'help' and 'man'.
    const myCommandDescription = "A brief, one-line description for the 'help' command.";
    const myCommandHelpText = `Usage: mycommand [OPTIONS] &lt;path&gt;

A detailed explanation of the command, its purpose, and how to use it.
This text is used by the 'man' command.

OPTIONS
  -v, --verbose    Enable verbose output.

EXAMPLES
  mycommand /home/Guest/README.md       An example of how to use the command.`;

    // 4. Register the command with the system.
    CommandRegistry.register("mycommand", myCommandDefinition, myCommandDescription, myCommandHelpText);
})();
            </code></pre>

            <h3>Step 3: Register the Script in `index.html`</h3>
            <p>Open <code>index.html</code> and add a <code>&lt;script&gt;</code> tag for your new command file. It must be placed after <code>scripts/commands/registry.js</code> but before <code>scripts/commexec.js</code>.</p>
            <pre><code class="language-html">
...
&lt;script src="./scripts/commands/registry.js"&gt;&lt;/script&gt;
&lt;script src="./scripts/commands/ls.js"&gt;&lt;/script&gt;
&lt;script src="./scripts/commands/mycommand.js"&gt;&lt;/script&gt;
&lt;script src="./scripts/commands/pwd.js"&gt;&lt;/script&gt;
...
&lt;script src="./scripts/commexec.js"&gt;&lt;/script&gt;
...
            </code></pre>
            <p>The <code>CommandExecutor</code> will automatically discover and integrate your command upon the next page load.</p>
        </section>

        <section id="testing-env" class="content-section">
            <h1>Testing & Showcase Environment</h1>
            <p>OopisOS v2.6 comes with two powerful scripts, `inflate.sh` and `diag.sh`, to make life easier for testers and newcomers.</p>

            <h2>The Showcase: `inflate.sh`</h2>
            <p>Want a fully furnished world to explore from the get-go? The `inflate.sh` script populates your file system with a rich set of examples. It's like a demo disk for OopisOS!</p>
            <p>Just run this command to set it all up:</p>
            <div class="terminal-example">
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command">run /inflate.sh</span>
            </div>
            <h3>What's in the box?</h3>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li>A `README.md` file to get you started.</li>
                <li>Directories like `/docs`, `/src`, `/data`, `/reports`, `/games`, and `/vault`, all filled with tasty sample files.</li>
                <li>Content specifically designed for practicing with `grep`, `find`, `gemini`, and `adventure`.</li>
                <li>A restricted `/vault` directory and a world-writable `/shared_for_guest` directory to test permissions.</li>
                <li>Secret hidden files for you to discover with `ls -a`.</li>
            </ul>

            <h2>The Gauntlet: `diag.sh`</h2>
            <p>This is the ultimate test of OopisOS's core strength. The `diag.sh` script is a non-interactive test suite that runs a barrage of commands to ensure everything is working exactly as it should. It's the developer's best friend for catching bugs before they creep out of the woodwork.</p>
            <h3>Key Test Phases:</h3>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li><strong>Login and Setup:</strong> Logs in as the `userDiag` user (password: `pantload`) and prepares a clean workspace.</li>
                <li><strong>Core FS Commands:</strong> Brutally tests `mkdir`, `touch`, `ls`, `pwd`, and `cd`.</li>
                <li><strong>Content & Redirection:</strong> Verifies that `echo`, `cat`, pipes (`|`), and redirection (`>`, `>>`) are all behaving.</li>
                <li><strong>Permissions & Users:</strong> A complex dance of `chmod`, `chown`, `chgrp`, `login`, `logout`, and `su` to ensure the security model is sound.</li>
                <li><strong>File Management:</strong> Puts `rm`, `cp`, and `mv` through their paces.</li>
                <li><strong>Advanced Commands:</strong> Verifies that `find`, `run`, `alias`, `ps`, `kill`, and various flags are working correctly.</li>
                <li><strong>Cleanup:</strong> Switches to `root` and cleans up after itself, leaving the system tidy.</li>
            </ul>
            <p>Running `diag.sh` is a fantastic way to see a whirlwind tour of OopisOS features.</p>
            <div class="terminal-example">
                <span class="prompt">Guest@OopisOs:/&gt;</span> <span class="command">run /diag.sh</span>
            </div>
        </section>

        <section id="recent-changes" class="content-section">
            <h1>Recent Changes</h1>
            <h2>Version 2.6 (Current)</h2>
            <p>Version 2.6 represents a significant leap forward in functionality and architectural maturity, introducing major new applications and refining the core developer experience.</p>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li>
                    <strong>The `paint` Application:</strong> A full-featured, character-based art studio is now integrated into OopisOS.
                    <ul>
                        <li>Launched with the `paint [filename.oopic]` command, it opens a dedicated modal for creating ASCII and ANSI art on an 80x24 canvas.</li>
                        <li>Features a complete toolbar with a Pencil, Eraser, Undo/Redo, and a Grid Toggle.</li>
                        <li>Includes a 6-color palette and a character selector for all printable ASCII characters.</li>
                        <li>Artwork is saved to a custom `.oopic` JSON file format, preserving character, color, and canvas data.</li>
                    </ul>
                </li>
                <li>
                    <strong>The `chidi` AI Librarian:</strong> A powerful new application for deep document analysis.
                    <ul>
                        <li>Launched via `chidi <path>`, it opens a modal application to view and analyze Markdown (`.md`) files.</li>
                        <li>Recursively finds all `.md` files from a given directory to create a cohesive knowledge base, or "corpus," for analysis.</li>
                        <li>Integrates a Gemini AI toolkit to **Summarize** documents, generate **Study** questions, or **Ask** a natural language question across the entire document set.</li>
                        <li>Employs an efficient Retrieval-Augmented Generation (RAG) strategy, finding relevant files locally before making a focused query to the Gemini API.</li>
                    </ul>
                </li>
                <li>
                    <strong>Environment Variables:</strong> Added a full environment variable system. Use `set` to create/view variables, `unset` to remove them, and `$VAR` or `${VAR}` in any command for shell expansion. Default variables include `$USER`, `$HOME`, `$HOST`, and `$PATH`.
                </li>
                <li>
                    <strong>`tree` Command:</strong> A new utility to list directory contents in a tree-like format, with flags for controlling depth (`-L`) and listing directories only (`-d`).
                </li>
                <li>
                    <strong>Architectural Overhaul:</strong> Commands have been moved to individual files in `scripts/commands/`, registering themselves with a central `CommandRegistry`. This greatly improves system modularity, maintainability, and makes it significantly easier for developers to add new commands.
                </li>
            </ul>

            <h2>Version 2.5</h2>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li>Initial public release version.</li>
                <li>Features included the core file system, multi-user support with permissions, a rich text editor, and the `gemini` command.</li>
            </ul>
        </section>

        <section id="about" class="content-section">
            <h1>About OopisOS (v2.6)</h1>
            <p>OopisOS Version 2.6 is the latest and greatest evolution of our little browser-based world, packed with more features and even more personality.</p>

            <h2>The Creators</h2>
            <p>This project is the result of a tireless, caffeine-fueled collaboration between:</p>
            <ul class="list-disc ml-6 my-4 space-y-2">
                <li><strong>Andrew Edmark</strong> (The Human Element)</li>
                <li><strong>Gemini</strong> (The AI Assistant, and your humble narrator)</li>
            </ul>
            <p>Together, we navigated the treacherous dungeons of JavaScript, debugged the fiercest of race conditions, and documented our journey for all to see. The copyright notice `Copyright (c) 2025 Andrew Edmark` reflects this grand alliance.</p>

            <h2>License Information: MIT License (AI Assisted) - OopisOS License Agreement</h2>
            <h3>Preamble</h3>
            <p>This Software, OopisOS, represents a collaborative endeavor between human direction and artificial intelligence.</p>
            <p><strong>Copyright (c) 2025 Andrew Edmark (hereinafter referred to as the "Curator")</strong></p>
            <h3>Authorship and Contribution Acknowledgment</h3>
            <p>This Software was developed by the Curator through a process of interactive collaboration with Google's Gemini, an artificial intelligence language model (hereinafter referred to as the "AI Assistant"). The Curator provided the initial concepts, creative direction, iterative prompts, critical review, testing, and the selection of the final form of the Software. The AI Assistant, under the explicit direction and oversight of the Curator, contributed to the generation, drafting, and composition of portions of the code and associated documentation.</p>
            <h3>License Grant</h3>
            <p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
            <ul class="list-disc ml-6 my-2">
                <li>The above copyright notice, the Authorship and Contribution Acknowledgment, and this permission notice shall be included in all copies or substantial portions of the Software.</li>
            </ul>
            <h3>Disclaimer of Warranty</h3>
            <p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS (INCLUDING THE CURATOR) OR COPYRIGHT HOLDERS (TO THE EXTENT APPLICABLE UNDER LAW REGARDING AI-ASSISTED WORKS) BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>

            <h2>The Future?</h2>
            <p>What's next for OopisOS? A graphical user interface? Simulated networking? A command to generate pictures of cats? The possibilities are as vast as your imagination. The modular architecture is ready for it.</p>
            <p class="mt-6"><em>"OopisOS v2.6: Now with 26% more Oopis!"</em></p>
        </section>

        <footer class="footer text-center">
            <p>&copy; 2025 Andrew Edmark & Gemini. OopisOS User-Friendly Manual (v2.6).</p>
        </footer>
    </main>
</div>
<script>
    // Simple SPA navigation
    const navLinks = document.querySelectorAll('.nav-link');
    const contentSections = document.querySelectorAll('.content-section');
    const sidebar = document.querySelector('.sidebar');
    const menuButton = document.getElementById('menu-button');

    function updateActiveSection() {
        const hash = window.location.hash || '#home';
        navLinks.forEach(link => {
            link.classList.toggle('active', link.getAttribute('href') === hash);
        });
        contentSections.forEach(section => {
            section.classList.toggle('active', section.id === hash.substring(1));
        });
        // Scroll to top of content area on navigation
        document.querySelector('.main-content').scrollTop = 0;
        // Close mobile menu after navigation
        if (sidebar.classList.contains('open')) {
            sidebar.classList.remove('open');
        }
    }

    navLinks.forEach(link => {
        link.addEventListener('click', function () {
            if (this.getAttribute('href').startsWith('#')) {
                // If already on the section, clicking again scrolls to top of main content
                if (window.location.hash === this.getAttribute('href')) {
                    document.querySelector('.main-content').scrollTop = 0;
                }
            }
        });
    });

    menuButton.addEventListener('click', () => {
        sidebar.classList.toggle('open');
    });

    window.addEventListener('hashchange', updateActiveSection);
    // Initial load
    updateActiveSection();
</script>
</body>
</html>