/* OopisOS v3.1: Vanilla Style Sheet */
/* Phase 1 & 2: Audit, Architecture, and Design Token System */

/* 1. Design Tokens (Root Variables)
/* ========================================================================== */
/* This section replaces the Tailwind theme. All colors, fonts, and spacing
   are defined here as CSS custom properties for global consistency and
   easy maintenance. */
:root {
  /* Colors */
  --color-text-primary: #22c55e;      /* text-green-500 */
  --color-text-secondary: #a3a3a3;  /* text-neutral-400 */
  --color-text-subtle: #737373;     /* text-neutral-500 */
  --color-text-link: #2dd4bf;         /* custom */
  --color-text-link-hover: #5eead4;   /* custom */

  --color-accent-sky: #38bdf8;        /* text-sky-400 */
  --color-accent-amber: #fbbF24;      /* text-amber-400 */
  --color-accent-lime: #a3e635;       /* text-lime-400 */

  --color-success: var(--color-accent-lime);
  --color-warning: var(--color-accent-amber);
  --color-error: #ef4444;           /* text-red-500 */
  --color-info: var(--color-accent-sky);

  --color-background-darkest: #0a0a0a;  /* Near black */
  --color-background-dark: #1a1a1a;
  --color-background-medium: #27272a; /* zinc-800 */
  --color-background-light: #3f3f46;  /* zinc-700 */
  --color-border-primary: #52525b;     /* zinc-600 */
  --color-border-secondary: #3f3f46;   /* zinc-700 */

  /* Typography */
  --font-family-mono: 'VT323', monospace;
  --font-family-sans: 'Inter', sans-serif; /* A sensible default for UI elements */
  --font-size-sm: 0.875rem; /* 14px */
  --font-size-base: 1rem;     /* 16px */
  --font-size-lg: 1.125rem;  /* 18px */
  --font-size-xl: 1.25rem;   /* 20px */
  --font-size-2xl: 1.5rem;    /* 24px */
  --line-height-base: 1.5;
  --line-height-terminal: 1.35;

  /* Spacing */
  --spacing-xs: 0.25rem; /* 4px */
  --spacing-sm: 0.5rem;  /* 8px */
  --spacing-md: 1rem;    /* 16px */
  --spacing-lg: 1.5rem;  /* 24px */
  --spacing-xl: 2rem;    /* 32px */

  /* Borders & Radius */
  --border-radius-sm: 0.25rem; /* 4px */
  --border-radius-md: 0.5rem;  /* 8px */
  --border-radius-lg: 1rem;    /* 16px */
  --border-width: 1px;
  --border-width-thick: 2px;

  /* Shadows */
  --shadow-inset-light: inset 0 0 10px rgba(0, 255, 0, 0.1);
  --shadow-inset-dark: inset 0 0 15px rgba(0, 0, 0, 0.5);
  --shadow-drop-medium: 0 5px 15px rgba(0, 0, 0, 0.3);
}

/* 2. Base & Reset Styles
/* ========================================================================== */
/* A simple reset to ensure cross-browser consistency. */

*,
*::before,
*::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  font-size: var(--font-size-base);
  line-height: var(--line-height-base);
  -webkit-text-size-adjust: 100%;
}

body {
  font-family: var(--font-family-mono);
  background-color: var(--color-background-dark);
  color: var(--color-text-primary);
  min-height: 100vh;
  display: grid;
  place-items: center;
  overflow: hidden; /* Prevents scrollbars on the body */
}

/* 3. Layout Architecture
/* ========================================================================== */
/* Defines the primary layout containers of the application. */

#app-container {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100vh;
  padding: var(--spacing-md);
  gap: var(--spacing-sm);
}

#main-header, #main-footer {
  flex-shrink: 0;
  text-align: center;
  font-family: var(--font-family-mono);
  font-size: var(--font-size-xl);
  color: var(--color-text-primary);
}

#main-footer a {
  color: var(--color-text-link);
  text-decoration: none;
}
#main-footer a:hover {
  text-decoration: underline;
  color: var(--color-text-link-hover);
}

#terminal-bezel {
  flex-grow: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--spacing-lg);
  background-color: var(--color-background-medium);
  border-radius: var(--border-radius-lg);
  box-shadow: var(--shadow-inset-dark), var(--shadow-drop-medium);
  min-height: 0;
  width: 100%;
  max-width: 1300px; /* Constraint */
}

/* 4. Terminal Component (BEM-like)
/* ========================================================================== */
/* All styles related to the core terminal interface. */

.terminal {
  width: 100%;
  height: 100%;
  background-color: var(--color-background-darkest);
  border: var(--border-width-thick) solid var(--color-border-secondary);
  border-radius: var(--border-radius-md);
  padding: var(--spacing-md);
  box-shadow: var(--shadow-inset-light);
  overflow: hidden;
  display: grid;
  grid-template-rows: 1fr auto;
  position: relative; /* For child absolute positioning */
}

.terminal__output {
  overflow-y: auto;
  overflow-x: hidden;
  word-break: break-word;
  padding-right: var(--spacing-sm);
  min-height: 0;
}

.terminal__output-line {
  white-space: pre-wrap;
  min-height: var(--line-height-terminal);
  line-height: var(--line-height-terminal);
}

.terminal__input-line {
  display: flex;
  align-items: flex-start;
  line-height: var(--line-height-terminal);
  padding-top: var(--spacing-xs);
}

.terminal__prompt {
  flex-shrink: 0;
  white-space: nowrap;
  margin-right: var(--spacing-sm);
  color: var(--color-info);
}

.terminal__input {
  flex-grow: 1;
  min-width: 0;
  background: transparent;
  border: none;
  outline: none;
  color: var(--color-text-primary);
  caret-color: var(--color-text-primary);
  word-break: break-word;
  white-space: pre-wrap;
}

/* 5. App Layer & Modals
/* ========================================================================== */
/* Styles for full-screen applications and modal dialogs. */

#app-layer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 10;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: rgba(10, 10, 10, 0.85); /* Dark overlay */
  backdrop-filter: blur(2px);
}

/* Base styles for all modal dialogs */
.modal-dialog {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background-color: var(--color-background-darkest);
  color: var(--color-text-secondary);
  padding: var(--spacing-lg);
  border-radius: var(--border-radius-md);
  z-index: 100;
  min-width: 320px;
  max-width: 450px;
  box-shadow: var(--shadow-drop-medium);
  border: var(--border-width) solid var(--color-text-primary);
  font-family: var(--font-family-mono);
  text-align: center;
}

.modal-dialog p {
  margin-bottom: var(--spacing-md);
  font-size: var(--font-size-lg);
  line-height: 1.5;
  color: var(--color-text-primary);
}

.modal-dialog__buttons {
  display: flex;
  justify-content: center;
  gap: var(--spacing-md);
}

.modal-dialog__input {
  width: 100%;
  padding: var(--spacing-sm);
  margin-top: var(--spacing-sm);
  margin-bottom: var(--spacing-lg);
  background-color: var(--color-background-medium);
  border: var(--border-width) solid var(--color-border-primary);
  color: var(--color-text-secondary);
  border-radius: var(--border-radius-sm);
  font-family: var(--font-family-mono);
  font-size: var(--font-size-lg);
}

.modal-dialog__input:focus {
  outline: none;
  box-shadow: 0 0 5px var(--color-text-primary);
  border-color: var(--color-text-primary);
}

/* 6. General Components & Utilities
/* ========================================================================== */

/* General button styling */
.btn {
  padding: var(--spacing-xs) var(--spacing-sm);
  border: var(--border-width) solid var(--color-border-primary);
  border-radius: var(--border-radius-sm);
  cursor: pointer;
  font-family: var(--font-family-mono);
  font-size: var(--font-size-base);
  transition: background-color 0.15s ease-in-out, color 0.15s ease-in-out;
}

.btn:hover {
  background-color: var(--color-background-light);
}

/* Button modifiers */
.btn--confirm {
  border-color: var(--color-success);
  color: var(--color-success);
}
.btn--confirm:hover {
  background-color: var(--color-success);
  color: var(--color-background-darkest);
}

.btn--cancel {
  border-color: var(--color-error);
  color: var(--color-error);
}
.btn--cancel:hover {
  background-color: var(--color-error);
  color: var(--color-background-darkest);
}


/* Scrollbar styling for consistency */
.terminal__output,
.editor-pane,
#adventure-output {
  scrollbar-width: thin;
  scrollbar-color: var(--color-text-primary) var(--color-background-darkest);
}

.terminal__output::-webkit-scrollbar,
.editor-pane::-webkit-scrollbar,
#adventure-output::-webkit-scrollbar {
  width: 10px;
}

.terminal__output::-webkit-scrollbar-track,
.editor-pane::-webkit-scrollbar-track,
#adventure-output::-webkit-scrollbar-track {
  background: var(--color-background-darkest);
  border-radius: 8px;
}

.terminal__output::-webkit-scrollbar-thumb,
.editor-pane::-webkit-scrollbar-thumb,
#adventure-output::-webkit-scrollbar-thumb {
  background-color: var(--color-text-primary);
  border-radius: 10px;
  border: 2px solid var(--color-background-darkest);
}

/* Utility classes to replace the config.js object */
.hidden {
  display: none !important;
}

.text-error { color: var(--color-error); }
.text-success { color: var(--color-success); }
.text-warning { color: var(--color-warning); }
.text-info { color: var(--color-info); }
.text-subtle { color: var(--color-text-secondary); }
.text-dir { color: var(--color-info); font-weight: 600; }
.text-file { color: var(--color-text-primary); }

/* 7. Editor Component
/* ========================================================================== */

.editor-container {
  display: flex;
  flex-direction: column;
  width: 95%;
  height: 95%;
  max-width: 1200px;
  background-color: #1a1a1d;
  border: var(--border-width-thick) solid var(--color-border-primary);
  border-radius: var(--border-radius-md);
  padding: var(--spacing-md);
  box-shadow: var(--shadow-inset-dark), var(--shadow-drop-medium);
}

.editor__controls {
  padding-bottom: var(--spacing-sm);
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: var(--border-width) solid var(--color-border-secondary);
  margin-bottom: var(--spacing-sm);
  flex-shrink: 0;
}

.editor__controls-group {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
}

.editor__toolbar {
  display: flex;
  align-items: center;
  gap: var(--spacing-xs);
}

.editor__main-area {
  flex-grow: 1;
  display: flex;
  width: 100%;
  overflow: hidden;
  position: relative;
  min-height: 0;
}

.editor__gutter {
  flex-shrink: 0;
  width: 40px;
  padding: var(--spacing-xs) var(--spacing-sm) var(--spacing-xs) 0;
  text-align: right;
  color: var(--color-text-subtle);
  background-color: #171717;
  overflow-y: hidden;
  user-select: none;
  font-family: var(--font-family-mono);
  font-size: var(--font-size-sm);
  line-height: var(--line-height-terminal);
}

.editor__gutter--hidden-by-wrap {
  display: none !important;
}

.editor__textarea-wrapper {
  flex: 1;
  position: relative;
  overflow: hidden;
  border-right: var(--border-width) solid var(--color-border-secondary);
  min-width: 0;
}

.editor__textarea {
  width: 100%;
  height: 100%;
  background-color: var(--color-background-darkest);
  color: var(--color-text-primary);
  border: none;
  resize: none;
  outline: none;
  padding: var(--spacing-xs) var(--spacing-sm);
  font-family: var(--font-family-mono);
  font-size: var(--font-size-sm);
  line-height: var(--line-height-terminal);
}

.editor__textarea--no-wrap {
  white-space: pre !important;
  overflow-x: auto !important;
}

.editor__preview-wrapper {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 0;
  overflow-y: auto;
  background-color: #f9fafb;
  color: #111827;
  min-width: 0;
}

.editor__preview-content {
  padding: var(--spacing-md);
  flex-grow: 1;
}

/* Markdown-specific styling for the preview pane */
.markdown-preview h1, .markdown-preview h2, .markdown-preview h3 {
  color: #0284c7; border-bottom: 1px solid #e5e7eb; margin-top: 1.5rem; margin-bottom: 1rem; padding-bottom: 0.25rem;
}
.markdown-preview code {
  background-color: #f3f4f6; padding: 2px 4px; border-radius: 3px; font-family: monospace; color: #1f2937;
}
.markdown-preview pre {
  background-color: #f3f4f6; padding: 10px; overflow-x: auto; border-radius: 3px;
}
.markdown-preview blockquote {
  border-left: 3px solid #d1d5db; padding-left: 10px; margin-left: 0; color: #6b7280;
}

.editor__status-bar {
  padding: var(--spacing-xs) var(--spacing-sm);
  font-size: var(--font-size-sm);
  color: var(--color-text-subtle);
  border-top: var(--border-width) solid var(--color-border-secondary);
  background-color: #1f1f22;
  flex-shrink: 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.editor__status-bar-group {
  display: flex;
  gap: var(--spacing-md);
}

.editor__footer {
  padding-top: var(--spacing-sm);
  font-size: var(--font-size-sm);
  text-align: center;
  color: var(--color-text-secondary);
  flex-shrink: 0;
  border-top: var(--border-width) solid var(--color-border-secondary);
  margin-top: var(--spacing-sm);
}

/* Button component specific to the editor app */
.editor-btn {
  background-color: var(--color-background-light);
  color: var(--color-text-secondary);
  border: var(--border-width) solid var(--color-border-primary);
  padding: var(--spacing-xs) var(--spacing-sm);
  border-radius: var(--border-radius-sm);
  font-family: var(--font-family-sans);
  font-size: var(--font-size-sm);
  cursor: pointer;
  transition: background-color 0.15s, color 0.15s;
}
.editor-btn:hover:not(:disabled) {
  background-color: var(--color-border-primary);
  color: #fff;
}
.editor-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.editor-btn--format {
  background: transparent;
  border: none;
  color: var(--color-success);
  padding: var(--spacing-xs);
}
.editor-btn--format:hover:not(:disabled) {
  background-color: var(--color-background-light);
}
.editor-btn--format svg {
  width: 1.25em;
  height: 1.25em;
  fill: currentColor;
}

/* 8. Explorer Component
/* ========================================================================== */

.explorer-container {
  display: flex;
  flex-direction: column;
  background-color: var(--color-background-medium);
  border: var(--border-width-thick) solid var(--color-border-secondary);
  border-radius: var(--border-radius-md);
  color: var(--color-text-secondary);
  font-family: var(--font-family-mono);
  overflow: hidden;
  width: 95%;
  height: 95%;
  max-width: 1200px;
}

.explorer__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--spacing-sm);
  border-bottom: var(--border-width) solid var(--color-border-primary);
  flex-shrink: 0;
}

.explorer__title {
  font-size: var(--font-size-lg);
  color: var(--color-info);
}

.explorer__exit-btn {
  font-size: var(--font-size-lg);
  background: none;
  border: none;
  cursor: pointer;
  color: var(--color-text-secondary);
  transition: color 0.2s ease-in-out;
}

.explorer__exit-btn:hover {
  color: var(--color-error);
}

.explorer__main {
  display: flex;
  flex-grow: 1;
  min-height: 0;
}

.explorer__tree-pane,
.explorer__main-pane {
  padding: var(--spacing-sm);
  overflow-y: auto;
}

.explorer__tree-pane {
  width: 33.333333%;
  border-right: var(--border-width) solid var(--color-border-primary);
}

.explorer__main-pane {
  width: 66.666667%;
}

.explorer__status-bar {
  font-size: var(--font-size-sm);
  padding: var(--spacing-xs) var(--spacing-sm);
  border-top: var(--border-width) solid var(--color-border-primary);
  color: var(--color-text-secondary);
  flex-shrink: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* Tree and List item specific styles */
.explorer-tree, .explorer-file-list {
  list-style: none;
}

.explorer-tree-item summary {
  cursor: pointer;
  user-select: none;
  padding: var(--spacing-xs);
  border-radius: var(--border-radius-sm);
}

.explorer-tree-item summary:hover {
  background-color: var(--color-background-light);
}

.explorer-tree-item[open] > summary {
  background-color: var(--color-accent-sky);
  color: var(--color-background-darkest);
}

.explorer-tree-item .selected {
  background-color: var(--color-info);
  color: var(--color-background-darkest);
  font-weight: 600;
}

.explorer-file-list li {
  display: flex;
  align-items: center;
  padding: var(--spacing-xs);
  border-radius: var(--border-radius-sm);
  cursor: pointer;
}

.explorer-file-list li:hover {
  background-color: var(--color-background-light);
}

.explorer-item-name { flex: 1; }
.explorer-item-perms { font-size: var(--font-size-sm); color: var(--color-text-subtle); margin-right: var(--spacing-md); }
.explorer-item-size { font-size: var(--font-size-sm); color: var(--color-text-subtle); width: 6rem; text-align: right; }